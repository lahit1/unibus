#include <iostream>
#include <unordered_map>
#include <initializer_list>

#include <unibus/req>
#include <unibus/res>

namespace unibus {

	namespace Radix {

		struct N { // Node
			virtual void call(std::istream in, std::ostream out) = 0;
		};


		class H : N { // Handler node
			void (*worker_func)(Req req, Res res);

			public:
			void call(std::istream in, std::ostream out) override;
		};

		class S : N { // Search Node
			std::unordered_map<char, N> targets;

			public:
			void call(std::istream in, std::ostream out) override;
			void add(const std::initializer_list<char>& data, void (*worker_func)(Req req, Res res));
		};

	}

}
